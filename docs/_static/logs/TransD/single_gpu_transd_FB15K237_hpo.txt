DEBUG:cmd:2024-14-05 14:14:36:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/luyanfeng/my_code/github/pybind11-OpenKE, stdin=None, shell=False, universal_newlines=False)
DEBUG:cmd:2024-14-05 14:14:36:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/luyanfeng/my_code/github/pybind11-OpenKE, stdin=None, shell=False, universal_newlines=False)
DEBUG:connectionpool:2024-14-05 14:14:37:Starting new HTTPS connection (1): api.wandb.ai:443
DEBUG:connectionpool:2024-14-05 14:14:38:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:14:38:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
wandb: Currently logged in as: 3555028709. Use `wandb login --relogin` to force relogin
DEBUG:connectionpool:2024-14-05 14:14:38:Starting new HTTPS connection (1): api.wandb.ai:443
DEBUG:connectionpool:2024-14-05 14:14:39:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
INFO:pyagent:2024-14-05 14:14:39:Starting sweep agent: entity=None, project=None, count=3
DEBUG:pyagent:2024-14-05 14:14:39:Agent._setup()
DEBUG:pyagent:2024-14-05 14:14:39:Agent._register()
DEBUG:connectionpool:2024-14-05 14:14:39:Starting new HTTPS connection (1): api.wandb.ai:443
DEBUG:connectionpool:2024-14-05 14:14:40:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:pyagent:2024-14-05 14:14:40:agent_id = QWdlbnQ6czVmMWVvNXQ=
DEBUG:connectionpool:2024-14-05 14:14:40:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:pyagent:2024-14-05 14:14:40:Job received: Job(bamcqf5c,{'adv_temperature': {'value': 3}, 'batch_size': {'value': 4096}, 'dataloader': {'value': 'KGEDataLoader'}, 'delta': {'value': 0.0001}, 'device': {'value': 'cuda:1'}, 'dim_e': {'value': 200}, 'dim_r': {'value': 200}, 'ent_file': {'value': 'entity2id.txt'}, 'epochs': {'value': 10000}, 'in_path': {'value': '../../benchmarks/FB15K237/'}, 'l3_regul_rate': {'value': 0}, 'log_interval': {'value': 100}, 'loss': {'value': 'MarginLoss'}, 'lr': {'value': 0.5402928915141487}, 'margin': {'value': 6}, 'metric': {'value': 'hits@10'}, 'model': {'value': 'TransD'}, 'neg_ent': {'value': 4}, 'norm_flag': {'value': True}, 'num_workers': {'value': 16}, 'opt_method': {'value': 'sgd'}, 'p_norm': {'value': 2}, 'patience': {'value': 2}, 'prediction': {'value': 'all'}, 'regul_rate': {'value': 0}, 'rel_file': {'value': 'relation2id.txt'}, 'save_path': {'value': './model.pth'}, 'strategy': {'value': 'NegativeSampling'}, 'test_batch_size': {'value': 30}, 'test_file': {'value': 'test2id.txt'}, 'test_sampler': {'value': 'TradTestSampler'}, 'tester': {'value': 'Tester'}, 'train_file': {'value': 'train2id.txt'}, 'train_sampler': {'value': 'BernSampler'}, 'trainer': {'value': 'Trainer'}, 'type_constrain': {'value': True}, 'use_early_stopping': {'value': True}, 'use_gpu': {'value': True}, 'use_tqdm': {'value': False}, 'valid_file': {'value': 'valid2id.txt'}, 'valid_interval': {'value': 100}})
DEBUG:pyagent:2024-14-05 14:14:40:Spawning new thread for run bamcqf5c.
wandb: Agent Starting Run: bamcqf5c with config:
wandb: 	adv_temperature: 3
wandb: 	batch_size: 4096
wandb: 	dataloader: KGEDataLoader
wandb: 	delta: 0.0001
wandb: 	device: cuda:1
wandb: 	dim_e: 200
wandb: 	dim_r: 200
wandb: 	ent_file: entity2id.txt
wandb: 	epochs: 10000
wandb: 	in_path: ../../benchmarks/FB15K237/
wandb: 	l3_regul_rate: 0
wandb: 	log_interval: 100
wandb: 	loss: MarginLoss
wandb: 	lr: 0.5402928915141487
wandb: 	margin: 6
wandb: 	metric: hits@10
wandb: 	model: TransD
wandb: 	neg_ent: 4
wandb: 	norm_flag: True
wandb: 	num_workers: 16
wandb: 	opt_method: sgd
wandb: 	p_norm: 2
wandb: 	patience: 2
wandb: 	prediction: all
wandb: 	regul_rate: 0
wandb: 	rel_file: relation2id.txt
wandb: 	save_path: ./model.pth
wandb: 	strategy: NegativeSampling
wandb: 	test_batch_size: 30
wandb: 	test_file: test2id.txt
wandb: 	test_sampler: TradTestSampler
wandb: 	tester: Tester
wandb: 	train_file: train2id.txt
wandb: 	train_sampler: BernSampler
wandb: 	trainer: Trainer
wandb: 	type_constrain: True
wandb: 	use_early_stopping: True
wandb: 	use_gpu: True
wandb: 	use_tqdm: False
wandb: 	valid_file: valid2id.txt
wandb: 	valid_interval: 100
DEBUG:cmd:2024-14-05 14:14:41:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/luyanfeng/my_code/github/pybind11-OpenKE, stdin=None, shell=False, universal_newlines=False)
DEBUG:cmd:2024-14-05 14:14:41:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/luyanfeng/my_code/github/pybind11-OpenKE, stdin=None, shell=False, universal_newlines=False)
DEBUG:connectionpool:2024-14-05 14:14:41:Starting new HTTPS connection (1): api.wandb.ai:443
DEBUG:connectionpool:2024-14-05 14:14:42:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:14:42:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:cmd:2024-14-05 14:14:43:Popen(['git', 'cat-file', '--batch-check'], cwd=/home/luyanfeng/my_code/github/pybind11-OpenKE, stdin=<valid stream>, shell=False, universal_newlines=False)
DEBUG:connectionpool:2024-14-05 14:14:46:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /home/luyanfeng/my_code/github/pybind11-OpenKE/examples/TransD/wandb/run-20240514_141443-bamcqf5c
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run crimson-sweep-1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/3555028709/pybind11-ke-sweeps
wandb: üßπ View sweep at https://wandb.ai/3555028709/pybind11-ke-sweeps/sweeps/5lxxzx23
wandb: üöÄ View run at https://wandb.ai/3555028709/pybind11-ke-sweeps/runs/bamcqf5c
DEBUG:connectionpool:2024-14-05 14:14:51:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
INFO:Trainer:2024-14-05 14:14:53:[cuda:1] Initialization completed, start model training.
data_loader_config:
{'batch_size': {'values': [512, 1024, 2048, 4096]},
 'dataloader': {'value': 'KGEDataLoader'},
 'ent_file': {'value': 'entity2id.txt'},
 'in_path': {'value': './'},
 'neg_ent': {'values': [1, 4, 16, 64]},
 'num_workers': {'value': 16},
 'rel_file': {'value': 'relation2id.txt'},
 'test_batch_size': {'value': 30},
 'test_file': {'value': 'test2id.txt'},
 'test_sampler': {'value': 'TradTestSampler'},
 'train_file': {'value': 'train2id.txt'},
 'train_sampler': {'value': 'BernSampler'},
 'type_constrain': {'value': True},
 'valid_file': {'value': 'valid2id.txt'}}

kge_config:
{'dim_e': {'values': [50, 100, 200]},
 'dim_r': {'values': [50, 100, 200]},
 'model': {'value': 'TransD'},
 'norm_flag': {'value': True},
 'p_norm': {'values': [1, 2]}}

loss_config:
{'adv_temperature': {'values': [1.0, 3.0, 6.0]},
 'loss': {'value': 'MarginLoss'},
 'margin': {'values': [1.0, 3.0, 6.0]}}

strategy_config:
{'l3_regul_rate': {'value': 0.0},
 'regul_rate': {'value': 0.0},
 'strategy': {'value': 'NegativeSampling'}}

tester_config:
{'device': {'value': 'cuda:0'},
 'prediction': {'value': 'all'},
 'tester': {'value': 'Tester'},
 'use_gpu': {'value': True},
 'use_tqdm': {'value': False}}

trainer_config:
{'delta': {'value': 0.0001},
 'epochs': {'value': 10000},
 'log_interval': {'value': 100},
 'lr': {'distribution': 'uniform', 'max': 1.0, 'min': 1e-05},
 'metric': {'value': 'hits@10'},
 'opt_method': {'values': ['adam', 'adagrad', 'sgd']},
 'patience': {'value': 2},
 'save_path': {'value': './model.pth'},
 'trainer': {'value': 'Trainer'},
 'use_early_stopping': {'value': True},
 'valid_interval': {'value': 100}}

sweep_config:
{'method': 'bayes',
 'metric': {'goal': 'maximize', 'name': 'val/hits@10'},
 'name': 'TransD_FB15K237',
 'parameters': {'adv_temperature': {'values': [1.0, 3.0, 6.0]},
                'batch_size': {'values': [512, 1024, 2048, 4096]},
                'dataloader': {'value': 'KGEDataLoader'},
                'delta': {'value': 0.0001},
                'device': {'value': 'cuda:1'},
                'dim_e': {'values': [50, 100, 200]},
                'dim_r': {'values': [50, 100, 200]},
                'ent_file': {'value': 'entity2id.txt'},
                'epochs': {'value': 10000},
                'in_path': {'value': '../../benchmarks/FB15K237/'},
                'l3_regul_rate': {'value': 0.0},
                'log_interval': {'value': 100},
                'loss': {'value': 'MarginLoss'},
                'lr': {'distribution': 'uniform', 'max': 1.0, 'min': 1e-05},
                'margin': {'values': [1.0, 3.0, 6.0]},
                'metric': {'value': 'hits@10'},
                'model': {'value': 'TransD'},
                'neg_ent': {'values': [1, 4, 16, 64]},
                'norm_flag': {'value': True},
                'num_workers': {'value': 16},
                'opt_method': {'values': ['adam', 'adagrad', 'sgd']},
                'p_norm': {'values': [1, 2]},
                'patience': {'value': 2},
                'prediction': {'value': 'all'},
                'regul_rate': {'value': 0.0},
                'rel_file': {'value': 'relation2id.txt'},
                'save_path': {'value': './model.pth'},
                'strategy': {'value': 'NegativeSampling'},
                'test_batch_size': {'value': 30},
                'test_file': {'value': 'test2id.txt'},
                'test_sampler': {'value': 'TradTestSampler'},
                'tester': {'value': 'Tester'},
                'train_file': {'value': 'train2id.txt'},
                'train_sampler': {'value': 'BernSampler'},
                'trainer': {'value': 'Trainer'},
                'type_constrain': {'value': True},
                'use_early_stopping': {'value': True},
                'use_gpu': {'value': True},
                'use_tqdm': {'value': False},
                'valid_file': {'value': 'valid2id.txt'},
                'valid_interval': {'value': 100}}}

Create sweep with ID: 5lxxzx23
Sweep URL: https://wandb.ai/3555028709/pybind11-ke-sweeps/sweeps/5lxxzx23
DEBUG:connectionpool:2024-14-05 14:14:57:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:15:02:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:15:07:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:15:13:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:15:18:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:15:23:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:15:28:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:15:35:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:15:40:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:15:46:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:15:51:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:15:56:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:16:02:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:16:08:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:16:13:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:16:19:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:16:25:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:16:30:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:16:35:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:16:41:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:16:46:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:16:51:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:16:57:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:17:02:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:17:07:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:17:12:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:17:17:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:17:23:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:17:28:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:17:33:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:17:39:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:17:46:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:17:52:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:17:58:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:18:03:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:18:08:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:18:14:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:18:20:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:18:25:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:18:30:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:18:35:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:18:41:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:18:46:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
INFO:Trainer:2024-14-05 14:18:47:[cuda:1] Epoch 100 | The model starts evaluation on the validation set.
DEBUG:connectionpool:2024-14-05 14:18:51:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
INFO:Trainer:2024-14-05 14:18:55:mr: 549.102
INFO:Trainer:2024-14-05 14:18:55:mrr: 0.148
INFO:Trainer:2024-14-05 14:18:55:hits@1: 0.087
INFO:Trainer:2024-14-05 14:18:55:hits@3: 0.157
INFO:Trainer:2024-14-05 14:18:55:hits@10: 0.272
INFO:Trainer:2024-14-05 14:18:55:mr_type: 239.262
INFO:Trainer:2024-14-05 14:18:55:mrr_type: 0.193
INFO:Trainer:2024-14-05 14:18:55:hits@1_type: 0.125
INFO:Trainer:2024-14-05 14:18:55:hits@3_type: 0.203
INFO:Trainer:2024-14-05 14:18:55:hits@10_type: 0.327
INFO:EarlyStopping:2024-14-05 14:18:55:Validation score improved (-inf --> 0.272000).  Saving model ...
INFO:Trainer:2024-14-05 14:18:55:[cuda:1] Epoch [ 100/10000] | Batchsize: 4096 | loss: 325.701855 | 2.33758 seconds/epoch
DEBUG:connectionpool:2024-14-05 14:18:57:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:19:02:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:19:07:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:19:13:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:19:19:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:19:24:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:19:29:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:19:36:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:19:42:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:19:48:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:19:53:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:19:59:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:20:04:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:20:10:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:20:16:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:20:22:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:20:27:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:20:32:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:20:37:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:20:43:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:20:48:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:20:53:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:20:59:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:21:04:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:21:10:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:21:15:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:21:24:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:21:29:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:21:34:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:21:39:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:21:45:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:21:53:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:21:59:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:22:04:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:22:10:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:22:15:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:22:21:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:22:26:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:22:31:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:22:36:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:22:42:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
INFO:Trainer:2024-14-05 14:22:45:[cuda:1] Epoch 200 | The model starts evaluation on the validation set.
DEBUG:connectionpool:2024-14-05 14:22:47:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:22:53:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
INFO:Trainer:2024-14-05 14:22:53:mr: 573.61
INFO:Trainer:2024-14-05 14:22:53:mrr: 0.148
INFO:Trainer:2024-14-05 14:22:53:hits@1: 0.089
INFO:Trainer:2024-14-05 14:22:53:hits@3: 0.155
INFO:Trainer:2024-14-05 14:22:53:hits@10: 0.267
INFO:Trainer:2024-14-05 14:22:53:mr_type: 242.521
INFO:Trainer:2024-14-05 14:22:53:mrr_type: 0.188
INFO:Trainer:2024-14-05 14:22:53:hits@1_type: 0.122
INFO:Trainer:2024-14-05 14:22:53:hits@3_type: 0.197
INFO:Trainer:2024-14-05 14:22:53:hits@10_type: 0.319
INFO:EarlyStopping:2024-14-05 14:22:53:EarlyStopping counter: 1 / 2
INFO:Trainer:2024-14-05 14:22:53:[cuda:1] Epoch [ 200/10000] | Batchsize: 4096 | loss: 324.265519 | 2.36003 seconds/epoch
DEBUG:connectionpool:2024-14-05 14:22:58:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:23:06:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:23:13:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:23:18:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:23:23:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:23:28:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:23:38:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:23:43:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:23:48:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:23:54:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:23:59:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:24:04:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:24:09:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:24:15:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:24:20:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:24:25:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:24:30:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:24:36:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:24:42:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:24:47:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:24:52:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:25:01:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:25:07:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:25:12:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:25:17:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:25:23:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:25:31:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:25:36:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:25:42:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:25:47:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:25:53:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:25:58:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:26:04:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:26:09:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:26:14:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:26:19:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:26:25:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:26:30:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:26:35:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
INFO:Trainer:2024-14-05 14:26:39:[cuda:1] Epoch 300 | The model starts evaluation on the validation set.
DEBUG:connectionpool:2024-14-05 14:26:41:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:26:46:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
INFO:Trainer:2024-14-05 14:26:47:mr: 578.51
INFO:Trainer:2024-14-05 14:26:47:mrr: 0.146
INFO:Trainer:2024-14-05 14:26:47:hits@1: 0.088
INFO:Trainer:2024-14-05 14:26:47:hits@3: 0.151
INFO:Trainer:2024-14-05 14:26:47:hits@10: 0.263
INFO:Trainer:2024-14-05 14:26:47:mr_type: 243.864
INFO:Trainer:2024-14-05 14:26:47:mrr_type: 0.185
INFO:Trainer:2024-14-05 14:26:47:hits@1_type: 0.12
INFO:Trainer:2024-14-05 14:26:47:hits@3_type: 0.191
INFO:Trainer:2024-14-05 14:26:47:hits@10_type: 0.313
INFO:EarlyStopping:2024-14-05 14:26:47:EarlyStopping counter: 2 / 2
INFO:Trainer:2024-14-05 14:26:47:[cuda:1] Send an early stopping signal
INFO:Trainer:2024-14-05 14:26:47:[cuda:1] The model training is completed, taking a total of 705.71076 seconds.
INFO:Trainer:2024-14-05 14:26:47:[cuda:1] Model saved at ./model.pth.
INFO:Trainer:2024-14-05 14:26:47:[cuda:1] The model starts evaluating in the test set.
DEBUG:connectionpool:2024-14-05 14:26:51:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:26:57:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
INFO:Trainer:2024-14-05 14:26:57:mr: 581.442
INFO:Trainer:2024-14-05 14:26:57:mrr: 0.142
INFO:Trainer:2024-14-05 14:26:57:hits@1: 0.085
INFO:Trainer:2024-14-05 14:26:57:hits@3: 0.147
INFO:Trainer:2024-14-05 14:26:57:hits@10: 0.257
INFO:Trainer:2024-14-05 14:26:57:mr_type: 246.108
INFO:Trainer:2024-14-05 14:26:57:mrr_type: 0.18
INFO:Trainer:2024-14-05 14:26:57:hits@1_type: 0.116
INFO:Trainer:2024-14-05 14:26:57:hits@3_type: 0.187
INFO:Trainer:2024-14-05 14:26:57:hits@10_type: 0.307
wandb: - 0.014 MB of 0.014 MB uploadedwandb: \ 0.014 MB of 0.042 MB uploadedwandb: | 0.040 MB of 0.042 MB uploadedwandb: / 0.040 MB of 0.042 MB uploadedwandb: - 0.040 MB of 0.042 MB uploadedDEBUG:connectionpool:2024-14-05 14:27:03:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
wandb: \ 0.040 MB of 0.042 MB uploadedwandb: | 0.040 MB of 0.042 MB uploadedwandb: / 0.040 MB of 0.042 MB uploadedwandb: - 0.040 MB of 0.042 MB uploadedwandb: \ 0.040 MB of 0.042 MB uploadedwandb: | 0.040 MB of 0.042 MB uploadedwandb: / 0.042 MB of 0.042 MB uploadedwandb:                                                                                
DEBUG:connectionpool:2024-14-05 14:27:09:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
wandb: 
wandb: Run history:
wandb:          duration ‚ñÅ
wandb:       test/hits@1 ‚ñÅ
wandb:      test/hits@10 ‚ñÅ
wandb: test/hits@10_type ‚ñÅ
wandb:  test/hits@1_type ‚ñÅ
wandb:       test/hits@3 ‚ñÅ
wandb:  test/hits@3_type ‚ñÅ
wandb:           test/mr ‚ñÅ
wandb:      test/mr_type ‚ñÅ
wandb:          test/mrr ‚ñÅ
wandb:     test/mrr_type ‚ñÅ
wandb:       train/epoch ‚ñÅ‚ñà
wandb:  train/train_loss ‚ñà‚ñÅ
wandb:         val/epoch ‚ñÅ‚ñÖ‚ñà
wandb:        val/hits@1 ‚ñÅ‚ñà‚ñÖ
wandb:       val/hits@10 ‚ñà‚ñÑ‚ñÅ
wandb:  val/hits@10_type ‚ñà‚ñÑ‚ñÅ
wandb:   val/hits@1_type ‚ñà‚ñÑ‚ñÅ
wandb:        val/hits@3 ‚ñà‚ñÜ‚ñÅ
wandb:   val/hits@3_type ‚ñà‚ñÖ‚ñÅ
wandb:            val/mr ‚ñÅ‚ñá‚ñà
wandb:       val/mr_type ‚ñÅ‚ñÜ‚ñà
wandb:           val/mrr ‚ñà‚ñà‚ñÅ
wandb:      val/mrr_type ‚ñà‚ñÑ‚ñÅ
wandb: 
wandb: Run summary:
wandb:          duration 705.71076
wandb:       test/hits@1 0.085
wandb:      test/hits@10 0.257
wandb: test/hits@10_type 0.307
wandb:  test/hits@1_type 0.116
wandb:       test/hits@3 0.147
wandb:  test/hits@3_type 0.187
wandb:           test/mr 581.442
wandb:      test/mr_type 246.108
wandb:          test/mrr 0.142
wandb:     test/mrr_type 0.18
wandb:       train/epoch 200
wandb:  train/train_loss 324.26552
wandb:         val/epoch 299
wandb:        val/hits@1 0.088
wandb:       val/hits@10 0.263
wandb:  val/hits@10_type 0.313
wandb:   val/hits@1_type 0.12
wandb:        val/hits@3 0.151
wandb:   val/hits@3_type 0.191
wandb:            val/mr 578.51
wandb:       val/mr_type 243.864
wandb:           val/mrr 0.146
wandb:      val/mrr_type 0.185
wandb: 
wandb: üöÄ View run crimson-sweep-1 at: https://wandb.ai/3555028709/pybind11-ke-sweeps/runs/bamcqf5c
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/3555028709/pybind11-ke-sweeps
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240514_141443-bamcqf5c/logs
DEBUG:connectionpool:2024-14-05 14:27:10:Starting new HTTPS connection (1): o151352.ingest.sentry.io:443
DEBUG:connectionpool:2024-14-05 14:27:11:https://o151352.ingest.sentry.io:443 "POST /api/4504800232407040/envelope/ HTTP/1.1" 200 0
DEBUG:connectionpool:2024-14-05 14:27:16:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
wandb: Agent Starting Run: 7wq14uub with config:
wandb: 	adv_temperature: 6
wandb: 	batch_size: 512
wandb: 	dataloader: KGEDataLoader
wandb: 	delta: 0.0001
wandb: 	device: cuda:1
wandb: 	dim_e: 200
wandb: 	dim_r: 50
wandb: 	ent_file: entity2id.txt
wandb: 	epochs: 10000
wandb: 	in_path: ../../benchmarks/FB15K237/
wandb: 	l3_regul_rate: 0
wandb: 	log_interval: 100
wandb: 	loss: MarginLoss
wandb: 	lr: 0.985120542836365
wandb: 	margin: 6
wandb: 	metric: hits@10
wandb: 	model: TransD
wandb: 	neg_ent: 4
wandb: 	norm_flag: True
wandb: 	num_workers: 16
wandb: 	opt_method: adagrad
wandb: 	p_norm: 1
wandb: 	patience: 2
wandb: 	prediction: all
wandb: 	regul_rate: 0
wandb: 	rel_file: relation2id.txt
wandb: 	save_path: ./model.pth
wandb: 	strategy: NegativeSampling
wandb: 	test_batch_size: 30
wandb: 	test_file: test2id.txt
wandb: 	test_sampler: TradTestSampler
wandb: 	tester: Tester
wandb: 	train_file: train2id.txt
wandb: 	train_sampler: BernSampler
wandb: 	trainer: Trainer
wandb: 	type_constrain: True
wandb: 	use_early_stopping: True
wandb: 	use_gpu: True
wandb: 	use_tqdm: False
wandb: 	valid_file: valid2id.txt
wandb: 	valid_interval: 100
DEBUG:cmd:2024-14-05 14:27:16:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/luyanfeng/my_code/github/pybind11-OpenKE, stdin=None, shell=False, universal_newlines=False)
DEBUG:cmd:2024-14-05 14:27:16:Popen(['git', 'rev-parse', '--show-toplevel'], cwd=/home/luyanfeng/my_code/github/pybind11-OpenKE, stdin=None, shell=False, universal_newlines=False)
DEBUG:connectionpool:2024-14-05 14:27:17:Starting new HTTPS connection (1): api.wandb.ai:443
DEBUG:connectionpool:2024-14-05 14:27:17:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:27:18:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:cmd:2024-14-05 14:27:18:Popen(['git', 'cat-file', '--batch-check'], cwd=/home/luyanfeng/my_code/github/pybind11-OpenKE, stdin=<valid stream>, shell=False, universal_newlines=False)
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...DEBUG:connectionpool:2024-14-05 14:27:21:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /home/luyanfeng/my_code/github/pybind11-OpenKE/examples/TransD/wandb/run-20240514_142718-7wq14uub
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sweet-sweep-2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/3555028709/pybind11-ke-sweeps
wandb: üßπ View sweep at https://wandb.ai/3555028709/pybind11-ke-sweeps/sweeps/5lxxzx23
wandb: üöÄ View run at https://wandb.ai/3555028709/pybind11-ke-sweeps/runs/7wq14uub
DEBUG:connectionpool:2024-14-05 14:27:26:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
INFO:Trainer:2024-14-05 14:27:27:[cuda:1] Initialization completed, start model training.
DEBUG:connectionpool:2024-14-05 14:27:33:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:27:39:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:27:44:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:27:49:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:27:54:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:28:00:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:28:05:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:28:10:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:28:15:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:28:21:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:28:27:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:28:32:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:28:37:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:28:42:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:28:49:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
DEBUG:connectionpool:2024-14-05 14:28:54:https://api.wandb.ai:443 "POST /graphql HTTP/1.1" 200 None
