Using RTX 4000 series which doesn't support faster communication speedups. Ensuring P2P and IB communications are disabled.
INFO:distributed_c10d:2024-12-05 16:58:22:Added key: store_based_barrier_key:1 to store for rank: 1
INFO:distributed_c10d:2024-12-05 16:58:23:Added key: store_based_barrier_key:1 to store for rank: 0
INFO:distributed_c10d:2024-12-05 16:58:23:Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO:distributed_c10d:2024-12-05 16:58:23:Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO:Trainer:2024-12-05 16:58:24:[cuda:1] Initialization completed, start model training.
INFO:Trainer:2024-12-05 16:58:24:[cuda:0] Initialization completed, start model training.
INFO:distributed:2024-12-05 16:58:26:Reducer buckets have been rebuilt in this iteration.
INFO:distributed:2024-12-05 16:58:26:Reducer buckets have been rebuilt in this iteration.
INFO:Trainer:2024-12-05 17:04:38:[cuda:0] Epoch 100 | The model starts evaluation on the validation set.
  0%|          | 0/69 [00:00<?, ?it/s]  1%|▏         | 1/69 [00:01<01:34,  1.38s/it]  3%|▎         | 2/69 [00:01<00:42,  1.57it/s]  4%|▍         | 3/69 [00:01<00:25,  2.55it/s]  6%|▌         | 4/69 [00:01<00:18,  3.56it/s]  7%|▋         | 5/69 [00:01<00:14,  4.55it/s]  9%|▊         | 6/69 [00:01<00:11,  5.53it/s] 10%|█         | 7/69 [00:02<00:09,  6.42it/s] 13%|█▎        | 9/69 [00:02<00:07,  8.04it/s] 16%|█▌        | 11/69 [00:02<00:06,  9.04it/s] 19%|█▉        | 13/69 [00:02<00:05,  9.69it/s] 22%|██▏       | 15/69 [00:02<00:05, 10.08it/s] 25%|██▍       | 17/69 [00:02<00:05, 10.36it/s] 28%|██▊       | 19/69 [00:03<00:04, 10.53it/s] 30%|███       | 21/69 [00:03<00:04, 10.69it/s] 33%|███▎      | 23/69 [00:03<00:04, 10.78it/s] 36%|███▌      | 25/69 [00:03<00:04, 10.85it/s] 39%|███▉      | 27/69 [00:03<00:03, 10.91it/s] 42%|████▏     | 29/69 [00:04<00:03, 10.95it/s] 45%|████▍     | 31/69 [00:04<00:03, 10.98it/s] 48%|████▊     | 33/69 [00:04<00:03, 11.02it/s] 51%|█████     | 35/69 [00:04<00:03, 11.05it/s] 54%|█████▎    | 37/69 [00:04<00:02, 11.07it/s] 57%|█████▋    | 39/69 [00:04<00:02, 11.09it/s] 59%|█████▉    | 41/69 [00:05<00:02, 11.10it/s] 62%|██████▏   | 43/69 [00:05<00:02, 11.12it/s] 65%|██████▌   | 45/69 [00:05<00:02, 11.12it/s] 68%|██████▊   | 47/69 [00:05<00:01, 11.13it/s] 71%|███████   | 49/69 [00:05<00:01, 11.13it/s] 74%|███████▍  | 51/69 [00:06<00:01, 11.13it/s] 77%|███████▋  | 53/69 [00:06<00:01, 11.14it/s] 80%|███████▉  | 55/69 [00:06<00:01, 11.14it/s] 83%|████████▎ | 57/69 [00:06<00:01, 11.14it/s] 86%|████████▌ | 59/69 [00:06<00:00, 11.14it/s] 88%|████████▊ | 61/69 [00:06<00:00, 11.13it/s] 91%|█████████▏| 63/69 [00:07<00:00, 11.14it/s] 94%|█████████▍| 65/69 [00:07<00:00, 11.13it/s] 97%|█████████▋| 67/69 [00:07<00:00, 11.13it/s]100%|██████████| 69/69 [00:07<00:00, 12.05it/s]100%|██████████| 69/69 [00:07<00:00,  8.99it/s]
INFO:Trainer:2024-12-05 17:04:45:mr: 244.334
INFO:Trainer:2024-12-05 17:04:45:mrr: 0.275
INFO:Trainer:2024-12-05 17:04:45:hits@1: 0.18
INFO:Trainer:2024-12-05 17:04:45:hits@3: 0.311
INFO:Trainer:2024-12-05 17:04:45:hits@10: 0.46
INFO:Trainer:2024-12-05 17:04:45:mr_type: 130.063
INFO:Trainer:2024-12-05 17:04:45:mrr_type: 0.321
INFO:Trainer:2024-12-05 17:04:45:hits@1_type: 0.23
INFO:Trainer:2024-12-05 17:04:45:hits@3_type: 0.352
INFO:Trainer:2024-12-05 17:04:45:hits@10_type: 0.502
INFO:EarlyStopping:2024-12-05 17:04:45:Validation score improved (-inf --> 0.460000).  Saving model ...
INFO:Trainer:2024-12-05 17:04:45:[cuda:0] Epoch 100 | Training checkpoint saved at ../../checkpoint/transh-100.pth
INFO:Trainer:2024-12-05 17:04:45:[cuda:0] Epoch [ 100/1000] | Batchsize: 8192 | loss:  0.499170 | 3.74025 seconds/epoch
INFO:Trainer:2024-12-05 17:04:45:[cuda:1] Epoch [ 100/1000] | Batchsize: 8192 | loss:  0.498411 | 3.74026 seconds/epoch
INFO:Trainer:2024-12-05 17:10:11:[cuda:0] Epoch 200 | The model starts evaluation on the validation set.
  0%|          | 0/69 [00:00<?, ?it/s]  1%|▏         | 1/69 [00:00<00:58,  1.16it/s]  4%|▍         | 3/69 [00:01<00:19,  3.43it/s]  7%|▋         | 5/69 [00:01<00:12,  5.32it/s] 10%|█         | 7/69 [00:01<00:09,  6.81it/s] 13%|█▎        | 9/69 [00:01<00:07,  7.96it/s] 16%|█▌        | 11/69 [00:01<00:06,  8.82it/s] 19%|█▉        | 13/69 [00:01<00:05,  9.46it/s] 22%|██▏       | 15/69 [00:02<00:05,  9.92it/s] 25%|██▍       | 17/69 [00:02<00:05, 10.24it/s] 28%|██▊       | 19/69 [00:02<00:04, 10.48it/s] 30%|███       | 21/69 [00:02<00:04, 10.65it/s] 33%|███▎      | 23/69 [00:02<00:04, 10.76it/s] 36%|███▌      | 25/69 [00:03<00:04, 10.85it/s] 39%|███▉      | 27/69 [00:03<00:03, 10.91it/s] 42%|████▏     | 29/69 [00:03<00:03, 10.95it/s] 45%|████▍     | 31/69 [00:03<00:03, 10.98it/s] 48%|████▊     | 33/69 [00:03<00:03, 10.99it/s] 51%|█████     | 35/69 [00:03<00:03, 11.00it/s] 54%|█████▎    | 37/69 [00:04<00:02, 11.01it/s] 57%|█████▋    | 39/69 [00:04<00:02, 11.03it/s] 59%|█████▉    | 41/69 [00:04<00:02, 11.06it/s] 62%|██████▏   | 43/69 [00:04<00:02, 11.09it/s] 65%|██████▌   | 45/69 [00:04<00:02, 11.10it/s] 68%|██████▊   | 47/69 [00:05<00:01, 11.11it/s] 71%|███████   | 49/69 [00:05<00:01, 11.12it/s] 74%|███████▍  | 51/69 [00:05<00:01, 11.12it/s] 77%|███████▋  | 53/69 [00:05<00:01, 11.13it/s] 80%|███████▉  | 55/69 [00:05<00:01, 11.10it/s] 83%|████████▎ | 57/69 [00:05<00:01, 11.11it/s] 86%|████████▌ | 59/69 [00:06<00:00, 11.12it/s] 88%|████████▊ | 61/69 [00:06<00:00, 11.13it/s] 91%|█████████▏| 63/69 [00:06<00:00, 11.13it/s] 94%|█████████▍| 65/69 [00:06<00:00, 11.13it/s] 97%|█████████▋| 67/69 [00:06<00:00, 11.14it/s]100%|██████████| 69/69 [00:06<00:00, 12.06it/s]100%|██████████| 69/69 [00:07<00:00,  9.74it/s]
INFO:Trainer:2024-12-05 17:10:18:mr: 225.999
INFO:Trainer:2024-12-05 17:10:18:mrr: 0.292
INFO:Trainer:2024-12-05 17:10:18:hits@1: 0.195
INFO:Trainer:2024-12-05 17:10:18:hits@3: 0.33
INFO:Trainer:2024-12-05 17:10:18:hits@10: 0.484
INFO:Trainer:2024-12-05 17:10:18:mr_type: 113.408
INFO:Trainer:2024-12-05 17:10:18:mrr_type: 0.339
INFO:Trainer:2024-12-05 17:10:18:hits@1_type: 0.246
INFO:Trainer:2024-12-05 17:10:18:hits@3_type: 0.373
INFO:Trainer:2024-12-05 17:10:18:hits@10_type: 0.527
INFO:EarlyStopping:2024-12-05 17:10:18:Validation score improved (0.460000 --> 0.484000).  Saving model ...
INFO:Trainer:2024-12-05 17:10:18:[cuda:0] Epoch 200 | Training checkpoint saved at ../../checkpoint/transh-200.pth
INFO:Trainer:2024-12-05 17:10:18:[cuda:1] Epoch [ 200/1000] | Batchsize: 8192 | loss:  0.373016 | 3.53623 seconds/epoch
INFO:Trainer:2024-12-05 17:10:18:[cuda:0] Epoch [ 200/1000] | Batchsize: 8192 | loss:  0.374192 | 3.53624 seconds/epoch
